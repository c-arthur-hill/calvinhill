RewriteEngine On
RewriteCond %{HTTP_HOST:X-FORWARDED-PROTO} !^www\. [NC]
RewriteRule (.*) https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]