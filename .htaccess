RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ %{REQUEST_SCHEME:X-FORWARDED-FOR}://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]